{
    "variables": {
      "aws_access_key": "{{env `AWS_ACCESS_KEY`}}",
      "aws_secret_key": "{{env `AWS_SECRET_KEY`}}",
      "aws_region": "{{env `AWS_REGION`}}",
      "aws_ami_id": "{{env `AWS_AMI_ID`}}"
    },

    "builders": [
        {
          "type": "amazon-ebs",
          "access_key": "{{user `aws_access_key`}}",
          "secret_key": "{{user `aws_secret_key`}}",
          "region": "us-west-2",
          "source_ami": "ami-5dd3743d",
          "instance_type": "t2.micro",
          "ami_name": "packer-example-ganymede-{{timestamp}}",
          "ssh_username": "ec2-user",
          "user_data_file" : "user-data.txt"
        }
    ],

    "description": "Packer example for ganymede.",

    "provisioners": [
        {
            "type": "shell",
            "script": "bootstrap.sh"
        },
        {
            "type": "file",
            "source": "../rocinante/build/rocinante.tar.gz",
            "destination": "/home/ec2-user/rocinante.tar.gz"
        },
        {
            "type": "file",
            "source": "validation.pem",
            "destination": "/etc/chef/validation.pem"
        },
        {
            "type": "file",
            "source": "client.rb",
            "destination": "/etc/chef/client.rb"
        },
        {
            "type": "chef-client",
            "server_url": "https://localhost/loganov"
        }

    ]
}
